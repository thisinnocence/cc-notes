# 关于`static`关键字

`static` 关键字在 C 和 C++ 中有多种用途，具体取决于它的作用域和修饰的对象。以下是系统总结：

## 1. 函数内的 `static` 变量

- **作用**: 在函数内声明的 `static` 变量具有静态存储周期，但其作用域仅限于函数内部。
- **特点**:
  - 变量只在第一次调用函数时初始化，后续调用保留上一次的值。
  - 默认值为零（如果未显式初始化）。
- **示例**:

  ```cpp
  void counter() {
      static int count = 0; // 静态变量，生命周期贯穿程序运行
      count++;
      std::cout << "Count: " << count << std::endl;
  }
  ```

## 2. 类内的 `static` 成员

- **作用**: 在类中声明的 `static` 成员变量或成员函数属于类本身，而不是某个具体对象。
- **特点**:
  - **静态成员变量**:
    - 所有对象共享同一份数据。
    - 必须在类外定义和初始化（C++ 中）。
    - 默认值为零（如果未显式初始化）。
  - **静态成员函数**:
    - 只能访问静态成员变量或调用其他静态成员函数。
    - 无法访问非静态成员或 `this` 指针。
- **示例**:

  ```cpp
  class MyClass {
  public:
      static int staticVar; // 声明静态成员变量
      static void staticFunc() {
          std::cout << "Static function called. StaticVar: " << staticVar << std::endl;
      }
  };

  int MyClass::staticVar = 10; // 定义并初始化静态成员变量
  ```

## 3. 全局作用域的 `static`

- **作用**: 在全局作用域中声明的 `static` 变量或函数，其作用域仅限于当前文件（内部链接）。
- **特点**:
  - 防止变量或函数被其他文件访问。
  - 常用于实现模块化和封装。
- **示例**:

  ```c
  static int globalVar = 42; // 仅限于当前文件
  static void helperFunction() {
      // 仅限于当前文件
  }
  ```

## 4. `static` 在纯 C 和 C++ 中的区别

- **C 中**:
  - `static` 主要用于函数内变量和全局变量的作用域控制。
  - 没有类的概念，因此无静态成员变量或成员函数。
- **C++ 中**:
  - 增加了类的支持，`static` 可用于类的成员变量和成员函数。
  - 支持更复杂的封装和模块化设计。

## 5. 是否需要初始化及默认值

- **函数内的 `static` 变量**:
  - 默认值为零（整数为 `0`，指针为 `nullptr`，浮点数为 `0.0`）。
  - 只在第一次调用时初始化。
- **类的静态成员变量**:
  - 必须显式初始化（在类外）。
  - 默认值为零（如果未显式初始化）。
- **全局作用域的 `static` 变量**:
  - 默认值为零（如果未显式初始化）。

## 6. 总结

| 作用域       | 修饰对象       | 生命周期         | 默认值 | 特点     |
|--------------|----------------|------------------|--------|-----------|
| 函数内       | 变量           | 程序运行期间     | 零     | 仅初始化一次，保留上次调用的值    |
| 类内         | 成员变量/函数  | 程序运行期间     | 零     | 属于类本身，所有对象共享，成员函数只能访问静态成员  |
| 全局作用域   | 变量/函数      | 程序运行期间     | 零     | 仅限于当前文件，防止外部访问              |

通过合理使用 `static` 关键字，可以有效控制变量和函数的作用域、生命周期以及访问权限，从而提高代码的封装性和模块化程度。
